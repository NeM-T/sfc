# 15章5～10
## 前回の復習+
* inodeはindex_nodeの略であり、1つのファイルやディレクトリに対して一意に対応する管理情報が保存されているデータ構造。
    * inode構造体の中身はstatをシステムコールすると見れる。  
    * /usr/include/x86_64-linux-gnu/bits/stat.hに詳細が書いてある。struct部分だけコピペしているのが[ここ](https://github.com/NeM-T/assembler/blob/master/cat/stat_struct.txt)にある。　~~輪講をしているころにはアセンブリで実装しているはず。してるといいな。~~ 
* dentryはファイルの使用が終了しても再び使用されることに備えて直ぐには解放しない。ページの回収処理の際に解放される。

## 15.5 inode構造体の管理構造
 inode構造体もハッシュ化リンクとつながっており、inodeのヘッドはsuper_block構造体のアドレスとiノード番号から計算される。   
  
 また、inode構造体はi_listメンバーを用いて状態を表すリストにつながる。  
 ![ハッシュ化リンクにつながっているinode構造体](./img/15-11.png)
   
inode構造体はdentry構造体と相互にポイントしているため、dentry構造体が解放された後に解放される。そのため、inode構造体のハッシュ化リストはdentry構造体の登場以降、使う機会が減少した。  

`$df -i` で現在のinode領域の使用状況を確認できる。各項目の意味は以下の通り  
* Inodes： デバイスで作成できるinodeの限界値
* IUsed ： 現在の使用量
* IFree ： 残り
* IUse  ： 使用率
  
また `$ls -i` によってinode番号を見ることができる。

## 15.6 super_block構造体の管理構造
super_blocksをヘッドとしてファイルシステムの種別が同じfile_system_type構造体のリンクとつながっている。  
リンクリスト全ファイルシステムを検索する際に使用される。  
  
### file_system_type
この構造体は各ファイルシステム種別ごとに存在する。  
リンクリストはマウント処理時に同じファイルシステムがマウントされていないか確認する際に使用される。  
![super_block構造体のリンク関係](./img/15-12.png)
  
## 15.7 名前空間の構成
Linuxの名前空間はファイルシステムによってあるパーティションとあるディレクトリを関連づけるマウントで構成されている。  

### vfsmount構造体
### namespace構造体
### fs_struct構造体

## 15.8 ファイルオペレーション

## 15.9 名前空間の実装
### パス名ルックアップ処理の実装
### マウント、アンマウントの実装

## 15.10 まとめ

## 参考
* [Linuxのファイルシステムについて](https://qiita.com/kamihork/items/fbcd116a631324aae05d)
* Linuxカーネル解読室2.6 15章
* [Linux - mount / unmount of File System](https://www.infraeye.com/study/linuxz24.html)
